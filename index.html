<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RPG Clicker: SƒÉn Boss ƒê·ªïi Th∆∞·ªüng</title>
    <style>
        :root {
            --bg-color: #1a1a2e;
            --panel-color: #16213e;
            --accent-color: #0f3460;
            --text-color: #e94560;
            --gold-color: #ffd700;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: white;
            margin: 0;
            padding: 0;
            user-select: none; /* Ch·ªëng b√¥i ƒëen khi click nhanh */
            overflow-x: hidden;
        }

        /* --- Header & Stats --- */
        .header {
            background-color: var(--panel-color);
            padding: 10px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 5px;
            font-size: 0.9rem;
            max-width: 600px;
            margin: 0 auto;
        }

        .stat-item {
            background: rgba(0,0,0,0.2);
            padding: 5px;
            border-radius: 5px;
        }

        .coin-display {
            grid-column: span 3;
            background-color: #333;
            color: var(--gold-color);
            font-size: 1.2rem;
            font-weight: bold;
            margin-top: 5px;
        }

        /* --- Battle Area --- */
        .battle-area {
            height: 300px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            background: radial-gradient(circle, #2a2a4e 0%, #1a1a2e 70%);
        }

        .enemy {
            font-size: 80px;
            cursor: pointer;
            transition: transform 0.1s;
            position: relative;
        }

        .enemy:active {
            transform: scale(0.9);
        }

        .hp-bar-container {
            width: 80%;
            height: 20px;
            background-color: #444;
            border-radius: 10px;
            margin-top: 20px;
            overflow: hidden;
            border: 2px solid white;
        }

        .hp-bar-fill {
            height: 100%;
            background-color: #ff4d4d;
            width: 100%;
            transition: width 0.2s;
        }

        .damage-text {
            position: absolute;
            color: white;
            font-weight: bold;
            font-size: 20px;
            pointer-events: none;
            animation: floatUp 0.8s ease-out forwards;
        }

        .crit-text {
            color: #ff0;
            font-size: 28px;
            text-shadow: 0 0 5px red;
        }

        @keyframes floatUp {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-50px); opacity: 0; }
        }

        /* --- Navigation & Tabs --- */
        .nav-tabs {
            display: flex;
            justify-content: center;
            background: var(--panel-color);
        }

        .nav-btn {
            flex: 1;
            padding: 15px 0;
            background: none;
            border: none;
            color: #888;
            font-size: 1.2rem;
            cursor: pointer;
            border-bottom: 3px solid transparent;
        }

        .nav-btn.active {
            color: white;
            border-bottom: 3px solid var(--text-color);
        }

        .tab-content {
            display: none;
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
            padding-bottom: 50px;
        }

        .tab-content.active {
            display: block;
        }

        /* --- Items & Buttons --- */
        .item-card {
            background: var(--panel-color);
            margin-bottom: 10px;
            padding: 15px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border: 1px solid #333;
        }

        .btn-buy {
            background-color: var(--text-color);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }

        .btn-buy:disabled {
            background-color: #555;
            cursor: not-allowed;
        }

        .boss-btn {
            width: 100%;
            padding: 15px;
            margin-bottom: 10px;
            background: #660000;
            color: white;
            border: 2px solid #ff4d4d;
            font-size: 1.1rem;
            cursor: pointer;
        }

        /* Withdraw Form */
        .withdraw-form input, .withdraw-form select {
            width: 100%;
            padding: 10px;
            margin-bottom: 10px;
            background: #333;
            border: 1px solid #555;
            color: white;
            box-sizing: border-box;
        }

        .notification {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: #333;
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            display: none;
            z-index: 1000;
            border: 1px solid var(--gold-color);
        }

    </style>
</head>
<body>

    <div class="header">
        <div class="stats-grid">
            <div class="stat-item">‚ù§Ô∏è HP: <span id="stat-hp">100</span></div>
            <div class="stat-item">‚öîÔ∏è Dame: <span id="stat-atk">10</span></div>
            <div class="stat-item">üõ°Ô∏è Gi√°p: <span id="stat-def">0</span></div>
            <div class="stat-item">‚ö° Crit: <span id="stat-crit">0</span>%</div>
            <div class="stat-item">üê∂ Pet: <span id="stat-pet">Kh√¥ng</span></div>
            <div class="stat-item">üëæ Stage: <span id="stat-stage">1</span></div>
            <div class="stat-item coin-display">üí∞ Coin: <span id="stat-coin">0</span></div>
        </div>
    </div>

    <div class="battle-area" id="battle-area">
        <h3 id="enemy-name" style="margin:0; color:#aaa;">Slime C·ªè</h3>
        <div class="enemy" onclick="hitEnemy(event)">üëæ</div>
        <div class="hp-bar-container">
            <div class="hp-bar-fill" id="enemy-hp-bar"></div>
        </div>
        <div style="margin-top: 5px;">HP: <span id="enemy-hp">50</span> / <span id="enemy-max-hp">50</span></div>
    </div>

    <div class="nav-tabs">
        <button class="nav-btn active" onclick="openTab('upgrade')">üìå Upgrade</button>
        <button class="nav-btn" onclick="openTab('shop')">üìå Shop</button>
        <button class="nav-btn" onclick="openTab('boss')">üìå Boss</button>
        <button class="nav-btn" onclick="openTab('wallet')">üìå R√∫t ti·ªÅn</button>
    </div>

    <div id="upgrade" class="tab-content active">
        <h3>N√¢ng c·∫•p ch·ªâ s·ªë</h3>
        <div class="item-card">
            <div>
                <div><b>Luy·ªán t·∫≠p (TƒÉng ATK)</b></div>
                <div style="font-size: 0.8rem; color: #888;">+2 Dame</div>
            </div>
            <button class="btn-buy" onclick="upgrade('atk')">üí∞ <span id="cost-atk">50</span></button>
        </div>
        <div class="item-card">
            <div>
                <div><b>ƒÇn u·ªëng (TƒÉng HP)</b></div>
                <div style="font-size: 0.8rem; color: #888;">+20 HP t·ªëi ƒëa</div>
            </div>
            <button class="btn-buy" onclick="upgrade('hp')">üí∞ <span id="cost-hp">50</span></button>
        </div>
        <div class="item-card">
            <div>
                <div><b>C∆∞·ªùng h√≥a (TƒÉng Crit)</b></div>
                <div style="font-size: 0.8rem; color: #888;">+1% T·ªâ l·ªá ch√≠ m·∫°ng</div>
            </div>
            <button class="btn-buy" onclick="upgrade('crit')">üí∞ <span id="cost-crit">200</span></button>
        </div>
    </div>

    <div id="shop" class="tab-content">
        <h3>C·ª≠a h√†ng trang b·ªã</h3>
        <div class="item-card">
            <div>
                <div><b>‚öîÔ∏è Ki·∫øm G·ªó</b></div>
                <div style="font-size: 0.8rem; color: #888;">+50 Dame</div>
            </div>
            <button class="btn-buy" onclick="buyItem('sword1', 500)">üí∞ 500</button>
        </div>
        <div class="item-card">
            <div>
                <div><b>üõ°Ô∏è Gi√°p Da</b></div>
                <div style="font-size: 0.8rem; color: #888;">+10 Gi√°p (Gi·∫£m s√°t th∆∞∆°ng Boss)</div>
            </div>
            <button class="btn-buy" onclick="buyItem('armor1', 500)">üí∞ 500</button>
        </div>
        <h3>C·ª≠a h√†ng Pet</h3>
        <div class="item-card">
            <div>
                <div><b>üê∂ Ch√≥ Shibu (Level 1)</b></div>
                <div style="font-size: 0.8rem; color: #888;">T·ª± ƒë·ªông ƒë√°nh 1 l·∫ßn/gi√¢y</div>
            </div>
            <button class="btn-buy" onclick="buyPet(1000)">üí∞ 1000</button>
        </div>
    </div>

    <div id="boss" class="tab-content">
        <h3>SƒÉn Boss nh·∫≠n th∆∞·ªüng l·ªõn</h3>
        <p style="color: #aaa; font-size: 0.9rem;">Boss s·∫Ω t·∫•n c√¥ng l·∫°i b·∫°n. N·∫øu h·∫øt m√°u b·∫°n s·∫Ω thua!</p>
        <button class="boss-btn" onclick="summonBoss('daily')">üíÄ BOSS NG√ÄY (Th∆∞·ªüng x10)</button>
        <button class="boss-btn" style="background: #330000; border-color: #ff0000;" onclick="summonBoss('weekly')">üëø BOSS TU·∫¶N (Th∆∞·ªüng x50)</button>
        <button class="boss-btn" style="background: #222; border-color: #555;" onclick="returnToNormal()">üè≥Ô∏è Quay l·∫°i farm qu√°i th∆∞·ªùng</button>
    </div>

    <div id="wallet" class="tab-content">
        <h3>üè¶ R√∫t ti·ªÅn (M√¥ ph·ªèng)</h3>
        <div class="withdraw-form">
            <label>Ph∆∞∆°ng th·ª©c:</label>
            <select>
                <option>Momo</option>
                <option>Th·∫ª Viettel</option>
                <option>Th·∫ª Vina</option>
                <option>Bank (QR)</option>
            </select>
            <label>S·ªë ti·ªÅn mu·ªën r√∫t (Coin):</label>
            <input type="number" id="withdraw-amount" placeholder="Min: 10,000 Coin">
            <label>S·ªë ƒëi·ªán tho·∫°i / S·ªë t√†i kho·∫£n:</label>
            <input type="text" placeholder="Nh·∫≠p s·ªë...">
            <button class="btn-buy" style="width: 100%; margin-top: 10px;" onclick="withdraw()">X√°c nh·∫≠n r√∫t</button>
        </div>
        <p style="color: red; font-size: 0.8rem; margin-top: 10px;">*L∆∞u √Ω: ƒê√¢y ch·ªâ l√† game m√¥ ph·ªèng, kh√¥ng c√≥ gi√° tr·ªã ti·ªÅn th·∫≠t.</p>
    </div>

    <div id="notification" class="notification">Th√¥ng b√°o</div>

    <script>
        // --- Game Data ---
        let player = {
            hp: 100,
            maxHp: 100,
            atk: 10,
            def: 0,
            crit: 0,
            coin: 0,
            pet: 0, // 0: none, 1: has pet
            stage: 1
        };

        let enemy = {
            name: "Slime C·ªè",
            hp: 50,
            maxHp: 50,
            reward: 5,
            isBoss: false,
            damage: 0
        };

        let costs = {
            atk: 50,
            hp: 50,
            crit: 200
        };

        // Load Game Data
        if(localStorage.getItem('rpg_save')) {
            player = JSON.parse(localStorage.getItem('rpg_save'));
            // Recalculate costs based on stats (simple logic)
            costs.atk = 50 + (player.atk - 10) * 5;
            costs.hp = 50 + (player.maxHp - 100) * 2;
            costs.crit = 200 + player.crit * 50;
        }

        // --- Core Functions ---
        
        function updateUI() {
            document.getElementById('stat-hp').innerText = Math.floor(player.hp) + "/" + player.maxHp;
            document.getElementById('stat-atk').innerText = player.atk;
            document.getElementById('stat-def').innerText = player.def;
            document.getElementById('stat-crit').innerText = player.crit;
            document.getElementById('stat-coin').innerText = player.coin.toLocaleString();
            document.getElementById('stat-pet').innerText = player.pet > 0 ? "Shibu üê∂" : "Kh√¥ng";
            document.getElementById('stat-stage').innerText = player.stage;

            // Enemy UI
            document.getElementById('enemy-name').innerText = enemy.name;
            document.getElementById('enemy-hp').innerText = Math.floor(enemy.hp);
            document.getElementById('enemy-max-hp').innerText = enemy.maxHp;
            
            let percent = (enemy.hp / enemy.maxHp) * 100;
            if(percent < 0) percent = 0;
            document.getElementById('enemy-hp-bar').style.width = percent + "%";

            // Costs
            document.getElementById('cost-atk').innerText = costs.atk;
            document.getElementById('cost-hp').innerText = costs.hp;
            document.getElementById('cost-crit').innerText = costs.crit;

            // Save
            localStorage.setItem('rpg_save', JSON.stringify(player));
        }

        function spawnEnemy() {
            if(enemy.isBoss) return; // Don't respawn normal if fighting boss

            enemy.maxHp = Math.floor(50 * Math.pow(1.1, player.stage));
            enemy.hp = enemy.maxHp;
            enemy.reward = Math.floor(5 * Math.pow(1.1, player.stage));
            enemy.name = "Qu√°i c·∫•p " + player.stage;
            enemy.damage = 0; // Normal mobs don't attack back in this simple version
            
            const emojis = ["üëæ", "üëπ", "üíÄ", "üëª", "üëΩ", "ü§ñ"];
            document.querySelector('.enemy').innerText = emojis[player.stage % emojis.length];
            
            updateUI();
        }

        function hitEnemy(event) {
            // Calculate Damage
            let isCrit = Math.random() * 100 < player.crit;
            let damage = player.atk * (isCrit ? 2 : 1);
            
            enemy.hp -= damage;

            // Visual Effect
            showDamage(damage, isCrit, event);
            
            if (enemy.hp <= 0) {
                // Victory
                player.coin += enemy.reward;
                showNotify(`+${enemy.reward} Coin!`);
                
                if(enemy.isBoss) {
                    showNotify("üèÜ ƒê√£ di·ªát BOSS! Nh·∫≠n th∆∞·ªüng l·ªõn!");
                    player.coin += enemy.reward; // Bonus for boss
                    returnToNormal();
                } else {
                    player.stage++;
                    spawnEnemy();
                }
            } else {
                // Boss Counter Attack
                if(enemy.isBoss && enemy.damage > 0) {
                    let taken = enemy.damage - player.def;
                    if(taken < 0) taken = 0;
                    player.hp -= taken;
                    if(player.hp <= 0) {
                        player.hp = 0;
                        showNotify("üíÄ B·∫°n ƒë√£ b·ªã Boss ƒë√°nh b·∫°i!");
                        returnToNormal();
                        player.hp = player.maxHp; // Revive
                    }
                }
            }
            updateUI();
        }

        // Auto Attack (Pet)
        setInterval(() => {
            if(player.pet > 0 && enemy.hp > 0) {
                let damage = Math.floor(player.atk * 0.5); // Pet deals 50% damage
                enemy.hp -= damage;
                if(enemy.hp <= 0) {
                     // Reuse logic for kill (simplified)
                     player.coin += enemy.reward;
                     if(enemy.isBoss) {
                        returnToNormal();
                     } else {
                        player.stage++;
                        spawnEnemy();
                     }
                }
                updateUI();
            }
        }, 1000);

        function showDamage(dmg, isCrit, event) {
            const el = document.createElement('div');
            el.classList.add('damage-text');
            if(isCrit) el.classList.add('crit-text');
            el.innerText = isCrit ? "CRIT " + dmg : dmg;
            
            // Random position near center if event is null (pet attack)
            let x, y;
            if(event) {
                x = event.clientX;
                y = event.clientY;
            } else {
                const rect = document.querySelector('.battle-area').getBoundingClientRect();
                x = rect.left + rect.width / 2;
                y = rect.top + rect.height / 2;
            }

            el.style.left = x + 'px';
            el.style.top = y + 'px';
            
            document.body.appendChild(el);
            setTimeout(() => el.remove(), 800);
        }

        // --- Tabs Logic ---
        function openTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            
            document.getElementById(tabId).classList.add('active');
            event.currentTarget.classList.add('active');
        }

        // --- Upgrade & Shop Logic ---
        function upgrade(type) {
            let cost = costs[type];
            if(player.coin >= cost) {
                player.coin -= cost;
                if(type === 'atk') {
                    player.atk += 2;
                    costs.atk = Math.floor(costs.atk * 1.2);
                } else if (type === 'hp') {
                    player.maxHp += 20;
                    player.hp += 20;
                    costs.hp = Math.floor(costs.hp * 1.2);
                } else if (type === 'crit') {
                    player.crit += 1;
                    if(player.crit > 100) player.crit = 100;
                    costs.crit = Math.floor(costs.crit * 1.5);
                }
                showNotify("N√¢ng c·∫•p th√†nh c√¥ng!");
                updateUI();
            } else {
                showNotify("‚ùå Kh√¥ng ƒë·ªß ti·ªÅn!");
            }
        }

        function buyItem(item, price) {
            if(player.coin >= price) {
                player.coin -= price;
                if(item === 'sword1') {
                    player.atk += 50;
                    showNotify("Mua Ki·∫øm G·ªó th√†nh c√¥ng! (+50 Dame)");
                } else if (item === 'armor1') {
                    player.def += 10;
                    showNotify("Mua Gi√°p Da th√†nh c√¥ng! (+10 Def)");
                }
                updateUI();
            } else {
                showNotify("‚ùå Kh√¥ng ƒë·ªß ti·ªÅn!");
            }
        }

        function buyPet(price) {
            if(player.coin >= price) {
                if(player.pet > 0) {
                    showNotify("B·∫°n ƒë√£ c√≥ Pet r·ªìi!");
                    return;
                }
                player.coin -= price;
                player.pet = 1;
                showNotify("ƒê√£ mua Pet Shibu!");
                updateUI();
            } else {
                showNotify("‚ùå Kh√¥ng ƒë·ªß ti·ªÅn!");
            }
        }

        // --- Boss Logic ---
        function summonBoss(type) {
            if(enemy.isBoss) return;
            
            enemy.isBoss = true;
            document.querySelector('.enemy').innerText = type === 'daily' ? "üíÄ" : "üëø";
            
            if(type === 'daily') {
                enemy.name = "BOSS NG√ÄY";
                enemy.maxHp = player.atk * 20; // Scale with player
                enemy.hp = enemy.maxHp;
                enemy.reward = 500;
                enemy.damage = 10;
            } else {
                enemy.name = "BOSS TU·∫¶N";
                enemy.maxHp = player.atk * 100;
                enemy.hp = enemy.maxHp;
                enemy.reward = 5000;
                enemy.damage = 50;
            }
            showNotify("BOSS XU·∫§T HI·ªÜN!");
            updateUI();
        }

        function returnToNormal() {
            enemy.isBoss = false;
            spawnEnemy();
        }

        // --- Withdraw Logic ---
        function withdraw() {
            let amount = document.getElementById('withdraw-amount').value;
            if(amount < 10000) {
                showNotify("‚ùå T·ªëi thi·ªÉu r√∫t 10,000 Coin");
                return;
            }
            if(player.coin >= amount) {
                player.coin -= amount;
                showNotify(`‚úÖ Y√™u c·∫ßu r√∫t ${amount} Coin ƒë√£ g·ª≠i! (Gi·∫£ l·∫≠p)`);
                updateUI();
            } else {
                showNotify("‚ùå S·ªë d∆∞ kh√¥ng ƒë·ªß!");
            }
        }

        function showNotify(msg) {
            const noti = document.getElementById('notification');
            noti.innerText = msg;
            noti.style.display = 'block';
            setTimeout(() => {
                noti.style.display = 'none';
            }, 2000);
        }

        // Init
        spawnEnemy();
        updateUI();

    </script>
</body>
</html>
