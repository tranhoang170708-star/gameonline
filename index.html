<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚öîÔ∏è GAME ONLINE - RPG Phi√™u L∆∞u</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700;900&display=swap');
        
        * {
            font-family: 'Roboto', sans-serif;
        }
        
        body {
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        @keyframes ping {
            75%, 100% {
                transform: scale(2);
                opacity: 0;
            }
        }

        .animate-ping {
            animation: ping 0.6s cubic-bezier(0, 0, 0.2, 1);
        }

        @keyframes bounce {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        .animate-bounce {
            animation: bounce 1s infinite;
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: 0.5;
            }
        }

        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .slide-in {
            animation: slideIn 0.3s ease-out;
        }

        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(147, 51, 234, 0.5);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(147, 51, 234, 0.8);
        }

        .damage-popup {
            position: absolute;
            font-weight: bold;
            font-size: 24px;
            pointer-events: none;
            animation: damageFloat 1s ease-out forwards;
        }

        @keyframes damageFloat {
            0% {
                opacity: 1;
                transform: translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px);
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script>
        // ==================== GAME STATE ====================
        let gameState = {
            gameStarted: false,
            playerName: '',
            nameError: '',
            player: {
                name: '',
                hp: 100,
                maxHp: 100,
                atk: 2,
                def: 0,
                crit: 5,
                gold: 0,
                level: 1,
                exp: 0,
                currentStage: 1,
                totalMonstersKilled: 0,
                weapon: null,
                armor: null,
                pet: null,
                inventory: [],
                dailyBosses: 2,
                weeklyBosses: 3,
                lastDailyReset: Date.now(),
                lastWeeklyReset: Date.now(),
            },
            currentView: 'game',
            battleLog: [],
            monster: null,
            isInBattle: false,
            canAttack: true,
            autoFight: true, // T·ª∞ ƒê·ªòNG CHI·∫æN ƒê·∫§U
            adBoosts: {
                hp: { active: false, endTime: 0 },
                atk: { active: false, endTime: 0 },
                def: { active: false, endTime: 0 }
            },
            marketListings: [],
            tradeTarget: '',
            withdrawHistory: [],
            adsWatched: 0
        };

        // ==================== SHOP DATA ====================
        const weaponShop = [
            { name: 'Ki·∫øm G·ªó', atk: 20, price: 200, icon: 'ü™µ' },
            { name: 'Ki·∫øm ƒê√°', atk: 35, price: 500, icon: 'ü™®' },
            { name: 'Ki·∫øm S·∫Øt', atk: 50, price: 1000, icon: '‚öîÔ∏è' },
            { name: 'Ki·∫øm V√†ng', atk: 75, price: 2000, icon: 'üíõ' },
            { name: 'Ki·∫øm Kim C∆∞∆°ng', atk: 125, price: 3000, icon: 'üíé' },
            { name: 'Ki·∫øm C·∫ßu V·ªìng', atk: 180, price: 4500, icon: 'üåà' },
            { name: 'Ki·∫øm Th√°nh', atk: 300, price: 7000, icon: '‚ú®' },
        ];

        const armorShop = [
            { name: 'Gi√°p V·∫£i', def: 3, hp: 50, price: 500, icon: 'üëï' },
            { name: 'Gi√°p ƒê·ªìng', def: 7, hp: 75, price: 1000, icon: 'ü•â' },
            { name: 'Gi√°p S·∫Øt', def: 10, hp: 100, price: 1500, icon: 'üõ°Ô∏è' },
            { name: 'Gi√°p Kim C∆∞∆°ng', def: 15, hp: 150, price: 3000, icon: 'üí†' },
            { name: 'Gi√°p Th√°nh', def: 30, hp: 300, price: 5000, icon: 'üëë' },
        ];

        const petShop = [
            { name: 'G√† Con', atkBonus: 5, price: 500, icon: 'üêî' },
            { name: 'Ch√≥ Con', atkBonus: 8, price: 1000, icon: 'üêï' },
            { name: 'S√≥i X√°m', atkBonus: 13, price: 1500, icon: 'üê∫' },
            { name: 'Voi Ma M√∫t', atkBonus: 20, price: 2300, icon: 'üêò' },
            { name: 'R·ªìng Th·∫ßn', atkBonus: 30, price: 3500, icon: 'üêâ' },
        ];

        // ==================== SAVE/LOAD FUNCTIONS ====================
        function loadGameState() {
            try {
                const saved = localStorage.getItem('rpgGameState');
                return saved ? JSON.parse(saved) : null;
            } catch {
                return null;
            }
        }

        function saveGame() {
            try {
                localStorage.setItem('rpgGameState', JSON.stringify(gameState.player));
                localStorage.setItem('rpgWithdrawHistory', JSON.stringify(gameState.withdrawHistory));
                localStorage.setItem('rpgAutoFight', JSON.stringify(gameState.autoFight));
            } catch (e) {
                console.error('Kh√¥ng th·ªÉ l∆∞u game', e);
            }
        }

        // ==================== STATS CALCULATION ====================
        function getTotalStats() {
            let totalAtk = gameState.player.atk;
            let totalDef = gameState.player.def;
            let totalHp = gameState.player.maxHp;
            let totalCrit = gameState.player.crit;

            if (gameState.player.weapon) totalAtk += gameState.player.weapon.atk;
            if (gameState.player.armor) {
                totalDef += gameState.player.armor.def;
                totalHp += gameState.player.armor.hp;
            }
            if (gameState.player.pet) {
                totalAtk += Math.floor(totalAtk * (gameState.player.pet.atkBonus / 100));
            }

            // Ad boosts
            if (gameState.adBoosts.hp.active && Date.now() < gameState.adBoosts.hp.endTime) totalHp += 100;
            if (gameState.adBoosts.atk.active && Date.now() < gameState.adBoosts.atk.endTime) totalAtk += 75;
            if (gameState.adBoosts.def.active && Date.now() < gameState.adBoosts.def.endTime) totalDef += 10;

            return { totalAtk, totalDef, totalHp, totalCrit };
        }

        // ==================== MONSTER GENERATION ====================
        function generateMonster(stage, isBoss = false, bossType = 'normal') {
            const baseHp = 30 + stage * 15;
            const baseAtk = 1 + stage * 0.5;
            
            let hp = baseHp;
            let atk = baseAtk;
            let goldReward = 10 + stage * 5;
            let expReward = 20 + stage * 10;
            let name = `Qu√°i V·∫≠t Lv.${stage}`;
            let icon = 'üëæ';

            if (isBoss) {
                if (bossType === 'stage') {
                    hp = baseHp * 1.3;
                    atk = baseAtk * 1.2;
                    goldReward *= 2;
                    expReward *= 2;
                    name = `Boss ·∫¢i ${Math.floor(stage / 10) + 1}`;
                    icon = 'üëπ';
                } else if (bossType === 'daily') {
                    hp = baseHp * 3;
                    atk = baseAtk * 2;
                    goldReward *= 5;
                    expReward *= 3;
                    name = `Boss Ng√†y`;
                    icon = 'üî•';
                } else if (bossType === 'weekly') {
                    hp = baseHp * 5;
                    atk = baseAtk * 3;
                    goldReward *= 10;
                    expReward *= 5;
                    name = `Boss Tu·∫ßn`;
                    icon = '‚ö°';
                }
            }

            return {
                name,
                icon,
                hp: Math.floor(hp),
                maxHp: Math.floor(hp),
                atk: Math.floor(atk),
                goldReward: Math.floor(goldReward),
                expReward: Math.floor(expReward),
                stage,
                isBoss,
                bossType
            };
        }

        // ==================== BATTLE SYSTEM ====================
        function addLog(message, type = 'info') {
            gameState.battleLog.push({ message, type, time: Date.now() });
            if (gameState.battleLog.length > 10) {
                gameState.battleLog = gameState.battleLog.slice(-10);
            }
            render();
        }

        function startBattle(bossType = null) {
            const isBoss = bossType !== null;
            let newMonster;

            if (bossType === 'daily') {
                if (gameState.player.dailyBosses <= 0) {
                    addLog('‚ö†Ô∏è B·∫°n ƒë√£ h·∫øt l∆∞·ª£t ƒë√°nh Boss Ng√†y!', 'error');
                    return;
                }
                newMonster = generateMonster(gameState.player.currentStage, true, 'daily');
            } else if (bossType === 'weekly') {
                if (gameState.player.weeklyBosses <= 0) {
                    addLog('‚ö†Ô∏è B·∫°n ƒë√£ h·∫øt l∆∞·ª£t ƒë√°nh Boss Tu·∫ßn!', 'error');
                    return;
                }
                newMonster = generateMonster(gameState.player.currentStage, true, 'weekly');
            } else {
                const isStageBoss = gameState.player.totalMonstersKilled > 0 && gameState.player.totalMonstersKilled % 10 === 0;
                newMonster = generateMonster(gameState.player.currentStage, isStageBoss, isStageBoss ? 'stage' : null);
            }

            gameState.monster = newMonster;
            gameState.isInBattle = true;
            gameState.canAttack = true;
            gameState.battleLog = [];
            addLog(`‚öîÔ∏è Chi·∫øn ƒë·∫•u v·ªõi ${newMonster.icon} ${newMonster.name}!`, 'info');
            addLog(`üí° Click v√†o qu√°i ƒë·ªÉ t·∫•n c√¥ng!`, 'info');
        }

        function showDamagePopup(damage, isCrit, x, y) {
            const popup = document.createElement('div');
            popup.className = 'damage-popup';
            popup.textContent = isCrit ? `üí• ${damage}` : damage;
            popup.style.left = x + 'px';
            popup.style.top = y + 'px';
            popup.style.color = isCrit ? '#ff0000' : '#ffaa00';
            document.body.appendChild(popup);
            
            setTimeout(() => popup.remove(), 1000);
        }

        function playerAttack(e) {
            if (!gameState.canAttack || !gameState.monster || !gameState.isInBattle) return;

            const stats = getTotalStats();
            const isCrit = Math.random() * 100 < stats.totalCrit;
            let damage = stats.totalAtk;
            if (isCrit) damage *= 2;

            gameState.monster.hp = Math.max(0, gameState.monster.hp - damage);

            addLog(`üí• B·∫°n g√¢y ${damage} s√°t th∆∞∆°ng${isCrit ? ' (CH√ç M·∫†NG!)' : ''}`, 'success');

            gameState.canAttack = false;
            setTimeout(() => {
                gameState.canAttack = true;
            }, 200);

            if (gameState.monster.hp <= 0) {
                handleVictory(gameState.monster);
            } else {
                setTimeout(() => monsterAttack(), 500);
            }
        }

        function monsterAttack() {
            if (!gameState.monster || !gameState.isInBattle) return;

            const stats = getTotalStats();
            const damage = Math.max(1, gameState.monster.atk - stats.totalDef);
            gameState.player.hp = Math.max(0, gameState.player.hp - damage);

            addLog(`üî¥ ${gameState.monster.name} g√¢y ${damage} s√°t th∆∞∆°ng!`, 'error');

            if (gameState.player.hp <= 0) {
                handleDefeat();
            } else {
                render();
            }
        }

        function handleVictory(defeatedMonster) {
            const newGold = gameState.player.gold + defeatedMonster.goldReward;
            const newExp = gameState.player.exp + defeatedMonster.expReward;
            const expToLevel = gameState.player.level * 100;
            
            let newLevel = gameState.player.level;
            let remainingExp = newExp;
            let newAtk = gameState.player.atk;
            let newMaxHp = gameState.player.maxHp;

            while (remainingExp >= expToLevel) {
                remainingExp -= expToLevel;
                newLevel++;
                newAtk += 2;
                newMaxHp += 10;
            }

            gameState.player.gold = newGold;
            gameState.player.exp = remainingExp;
            gameState.player.level = newLevel;
            gameState.player.atk = newAtk;
            gameState.player.maxHp = newMaxHp;
            gameState.player.hp = gameState.player.maxHp;

            if (defeatedMonster.bossType === 'daily') {
                gameState.player.dailyBosses--;
            } else if (defeatedMonster.bossType === 'weekly') {
                gameState.player.weeklyBosses--;
            } else if (!defeatedMonster.isBoss) {
                gameState.player.currentStage++;
                gameState.player.totalMonstersKilled++;
            } else if (defeatedMonster.bossType === 'stage') {
                gameState.player.currentStage++;
                gameState.player.totalMonstersKilled++;
            }

            saveGame();

            addLog(`üéâ Chi·∫øn th·∫Øng! +${defeatedMonster.goldReward}üí∞ +${defeatedMonster.expReward}‚≠ê`, 'success');
            if (newLevel > gameState.player.level) {
                addLog(`üÜô Level Up! Lv.${newLevel}`, 'success');
            }

            gameState.isInBattle = false;
            gameState.monster = null;

            // ‚úÖ T·ª∞ ƒê·ªòNG SPAWN QU√ÅI M·ªöI SAU 1.5 GI√ÇY
            if (gameState.autoFight && gameState.currentView === 'game') {
                setTimeout(() => {
                    if (gameState.currentView === 'game' && !gameState.isInBattle) {
                        startBattle();
                    }
                }, 1500);
            }
        }

        function handleDefeat() {
            addLog('üíÄ B·∫°n ƒë√£ thua! -50% v√†ng', 'error');
            gameState.player.gold = Math.floor(gameState.player.gold * 0.5);
            gameState.player.hp = gameState.player.maxHp;
            saveGame();
            gameState.isInBattle = false;
            gameState.monster = null;
            
            // T·ª± ƒë·ªông spawn l·∫°i sau khi thua
            if (gameState.autoFight && gameState.currentView === 'game') {
                setTimeout(() => {
                    if (gameState.currentView === 'game' && !gameState.isInBattle) {
                        startBattle();
                    }
                }, 2000);
            }
        }

        // Toggle auto fight
        function toggleAutoFight() {
            gameState.autoFight = !gameState.autoFight;
            saveGame();
            render();
        }

        // ==================== SHOP FUNCTIONS ====================
        function buyItem(item, type) {
            if (gameState.player.gold < item.price) {
                addLog('‚ö†Ô∏è Kh√¥ng ƒë·ªß v√†ng!', 'error');
                return;
            }

            gameState.player.gold -= item.price;
            
            if (type === 'weapon') {
                gameState.player.weapon = item;
            } else if (type === 'armor') {
                gameState.player.armor = item;
                gameState.player.maxHp += item.hp;
                gameState.player.hp = gameState.player.maxHp;
            } else if (type === 'pet') {
                gameState.player.pet = item;
            }

            saveGame();
            addLog(`‚úÖ ƒê√£ mua ${item.icon} ${item.name}!`, 'success');
        }

        // ==================== UPGRADE FUNCTIONS ====================
        function upgradeStats(stat) {
            const costs = {
                atk: 100 + gameState.player.atk * 50,
                hp: 150 + gameState.player.maxHp * 2,
                crit: 200 + gameState.player.crit * 100
            };

            if (gameState.player.gold < costs[stat]) {
                addLog('‚ö†Ô∏è Kh√¥ng ƒë·ªß v√†ng ƒë·ªÉ n√¢ng c·∫•p!', 'error');
                return;
            }

            gameState.player.gold -= costs[stat];
            
            if (stat === 'atk') {
                gameState.player.atk += 5;
            } else if (stat === 'hp') {
                gameState.player.maxHp += 20;
                gameState.player.hp = gameState.player.maxHp;
            } else if (stat === 'crit') {
                gameState.player.crit += 2;
            }

            saveGame();
            addLog(`‚¨ÜÔ∏è ƒê√£ n√¢ng c·∫•p ${stat.toUpperCase()}!`, 'success');
        }

        // ==================== AD FUNCTIONS ====================
        function calculateAdReward() {
            const baseReward = 50;
            const difficulty = Math.max(1, gameState.player.currentStage / 10);
            const randomBonus = Math.random() * 0.5 + 0.75;
            return Math.floor(baseReward * difficulty * randomBonus);
        }

        function watchAd(type) {
            addLog('üì∫ ƒêang t·∫£i qu·∫£ng c√°o... (Demo mode)', 'info');
            
            setTimeout(() => {
                gameState.adsWatched++;
                
                if (type === 'hp' || type === 'atk' || type === 'def') {
                    const endTime = Date.now() + 10 * 60 * 1000;
                    gameState.adBoosts[type] = { active: true, endTime };
                    addLog(`‚úÖ Buff ${type.toUpperCase()} trong 10 ph√∫t!`, 'success');
                } else if (type === 'coin1') {
                    const bonus = calculateAdReward();
                    gameState.player.gold += bonus;
                    saveGame();
                    addLog(`üí∞ +${bonus} V√†ng t·ª´ qu·∫£ng c√°o!`, 'success');
                } else if (type === 'coin2') {
                    const bonus = calculateAdReward() * 2;
                    gameState.player.gold += bonus;
                    saveGame();
                    addLog(`üíé +${bonus} V√†ng t·ª´ 2 qu·∫£ng c√°o!`, 'success');
                }
                render();
            }, 2000);
        }

        // ==================== WITHDRAW FUNCTIONS ====================
        function addWithdrawHistory(method, amount, details) {
            const record = {
                id: Date.now(),
                date: new Date().toLocaleString('vi-VN'),
                method,
                amount,
                details,
                status: 'ƒêang x·ª≠ l√Ω',
                code: method === 'card' ? generateCardCode() : null
            };
            
            gameState.withdrawHistory.unshift(record);
            saveGame();
        }

        function generateCardCode() {
            const chars = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            let code = '';
            for (let i = 0; i < 12; i++) {
                code += chars[Math.floor(Math.random() * chars.length)];
            }
            return code;
        }

        function withdrawMoney(method, formData) {
            const minAmounts = {
                bank: 20000,
                momo: 20000,
                card: 10000
            };

            const amount = parseInt(formData.amount);

            if (amount < minAmounts[method]) {
                alert(`S·ªë ti·ªÅn t·ªëi thi·ªÉu l√† ${minAmounts[method].toLocaleString()}ƒë`);
                return;
            }

            if (method === 'card' && amount > 100000) {
                alert('Th·∫ª c√†o t·ªëi ƒëa 100,000ƒë');
                return;
            }

            addWithdrawHistory(method, amount, formData);
            alert(`‚úÖ Y√™u c·∫ßu r√∫t ${amount.toLocaleString()}ƒë ƒë√£ ƒë∆∞·ª£c ghi nh·∫≠n!\n\nTr·∫°ng th√°i: ƒêang x·ª≠ l√Ω\n\n(Demo mode: C·∫ßn backend th·∫≠t ƒë·ªÉ x·ª≠ l√Ω thanh to√°n)`);
            gameState.currentView = 'withdraw-history';
            render();
        }

        // ==================== CHARACTER CREATION ====================
        function handleCreateCharacter() {
            const nameInput = document.getElementById('playerNameInput');
            const playerName = nameInput.value.trim();

            if (playerName.length < 5) {
                gameState.nameError = 'T√™n ph·∫£i c√≥ √≠t nh·∫•t 5 k√Ω t·ª±!';
                render();
                return;
            }
            
            const hasNumber = /\d/.test(playerName);
            if (!hasNumber) {
                gameState.nameError = 'T√™n ph·∫£i c√≥ √≠t nh·∫•t 1 ch·ªØ s·ªë!';
                render();
                return;
            }

            gameState.player.name = playerName;
            gameState.gameStarted = true;
            saveGame();
            render();
        }

        // ==================== RENDER FUNCTIONS ====================
        function renderCharacterCreation() {
            return `
                <div class="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-black text-white p-4 md:p-8 flex items-center justify-center">
                    <div class="max-w-md w-full bg-gradient-to-br from-purple-800/50 to-blue-800/50 backdrop-blur-lg rounded-3xl p-6 md:p-8 shadow-2xl border border-purple-500/30 slide-in">
                        <div class="text-center mb-8">
                            <div class="text-6xl mb-4 animate-bounce">‚öîÔ∏è</div>
                            <h1 class="text-4xl md:text-5xl font-bold mb-2 bg-gradient-to-r from-yellow-400 to-pink-500 bg-clip-text text-transparent">
                                GAME ONLINE
                            </h1>
                            <p class="text-purple-300">B·∫Øt ƒë·∫ßu h√†nh tr√¨nh c·ªßa b·∫°n!</p>
                        </div>

                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-bold mb-2 text-purple-200">üéÆ T√™n Nh√¢n V·∫≠t</label>
                                <input
                                    type="text"
                                    id="playerNameInput"
                                    placeholder="T·ªëi thi·ªÉu 5 k√Ω t·ª± + 1 s·ªë"
                                    class="w-full px-4 py-3 bg-black/30 border-2 border-purple-500/50 rounded-xl focus:border-pink-500 focus:outline-none text-white placeholder-purple-300"
                                    onkeypress="if(event.key==='Enter') handleCreateCharacter()"
                                />
                                ${gameState.nameError ? `<p class="text-red-400 text-sm mt-2">‚ö†Ô∏è ${gameState.nameError}</p>` : ''}
                            </div>

                            <div class="bg-black/30 rounded-xl p-4 border border-purple-500/30">
                                <h3 class="font-bold mb-3 text-yellow-400 text-center">üìä NH√ÇN V·∫¨T BAN ƒê·∫¶U</h3>
                                <div class="grid grid-cols-2 gap-3 text-sm">
                                    <div class="bg-red-900/30 p-3 rounded-lg border border-red-500/30">
                                        <div class="text-center">
                                            <div class="text-2xl mb-1">‚ù§Ô∏è</div>
                                            <div class="font-bold">HP: 100</div>
                                        </div>
                                    </div>
                                    <div class="bg-orange-900/30 p-3 rounded-lg border border-orange-500/30">
                                        <div class="text-center">
                                            <div class="text-2xl mb-1">‚öîÔ∏è</div>
                                            <div class="font-bold">ATK: 2</div>
                                        </div>
                                    </div>
                                    <div class="bg-blue-900/30 p-3 rounded-lg border border-blue-500/30">
                                        <div class="text-center">
                                            <div class="text-2xl mb-1">üõ°Ô∏è</div>
                                            <div class="font-bold">DEF: 0</div>
                                        </div>
                                    </div>
                                    <div class="bg-yellow-900/30 p-3 rounded-lg border border-yellow-500/30">
                                        <div class="text-center">
                                            <div class="text-2xl mb-1">‚ö°</div>
                                            <div class="font-bold">CRIT: 5%</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <button
                                onclick="handleCreateCharacter()"
                                class="w-full py-4 bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 rounded-xl font-bold text-lg shadow-lg transform hover:scale-105 transition-all duration-200"
                            >
                                üéÆ B·∫ÆT ƒê·∫¶U PHI√äU L∆ØU
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderGameView() {
            const stats = getTotalStats();
            
            return `
                <div class="grid lg:grid-cols-2 gap-4 md:gap-6">
                    <!-- Battle Arena -->
                    <div class="bg-gradient-to-br from-purple-900/50 to-blue-900/50 rounded-2xl p-4 md:p-6 border-2 border-purple-500/30 shadow-xl">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-xl md:text-2xl font-bold bg-gradient-to-r from-yellow-400 to-pink-500 bg-clip-text text-transparent">
                                ‚öîÔ∏è CHI·∫æN TR∆Ø·ªúNG
                            </h2>
                            <button
                                onclick="toggleAutoFight()"
                                class="px-3 py-1 rounded-lg text-xs md:text-sm font-bold ${
                                    gameState.autoFight 
                                        ? 'bg-green-600 hover:bg-green-700' 
                                        : 'bg-gray-600 hover:bg-gray-700'
                                }"
                            >
                                ${gameState.autoFight ? 'üîÑ Auto ON' : '‚è∏Ô∏è Auto OFF'}
                            </button>
                        </div>
                        
                        ${!gameState.isInBattle ? `
                            <div class="text-center space-y-4">
                                <div class="text-6xl mb-4 animate-bounce">üè∞</div>
                                <p class="text-purple-300 mb-4">·∫¢i ${gameState.player.currentStage} - Qu√°i ƒë√£ ti√™u di·ªát: ${gameState.player.totalMonstersKilled}</p>
                                <p class="text-yellow-300 text-sm">
                                    ${gameState.player.totalMonstersKilled % 10 === 0 && gameState.player.totalMonstersKilled > 0 ? 'üëπ BOSS ·∫¢I S·∫ÆP XU·∫§T HI·ªÜN!' : `C√≤n ${10 - (gameState.player.totalMonstersKilled % 10)} qu√°i n·ªØa g·∫∑p Boss ·∫¢i`}
                                </p>
                                ${gameState.autoFight ? `
                                    <div class="bg-green-900/30 border border-green-500/50 rounded-lg p-3">
                                        <p class="text-green-300 text-sm">‚ö° Ch·∫ø ƒë·ªô t·ª± ƒë·ªông ƒëang B·∫¨T</p>
                                        <p class="text-xs text-green-200 mt-1">Qu√°i m·ªõi s·∫Ω t·ª± ƒë·ªông spawn sau ${gameState.player.hp < stats.totalHp ? '2' : '1.5'} gi√¢y</p>
                                    </div>
                                ` : `
                                    <button
                                        onclick="startBattle(); render();"
                                        class="w-full py-4 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 rounded-xl font-bold text-lg shadow-lg transform hover:scale-105 transition-all"
                                    >
                                        ‚öîÔ∏è B·∫ÆT ƒê·∫¶U CHI·∫æN ƒê·∫§U
                                    </button>
                                `}
                            </div>
                        ` : `
                            <div class="space-y-4">
                                <!-- Monster -->
                                <div 
                                    onclick="playerAttack(event)"
                                    class="bg-red-900/30 rounded-xl p-4 md:p-6 border-2 border-red-500/50 cursor-pointer hover:bg-red-800/40 hover:border-red-400 hover:scale-105 transition-all duration-200 relative overflow-hidden active:scale-95"
                                    style="user-select: none"
                                >
                                    <div class="text-center relative z-10">
                                        <div class="text-5xl md:text-7xl mb-3 animate-bounce">${gameState.monster.icon}</div>
                                        <h3 class="font-bold text-xl md:text-2xl text-red-300 mb-2">${gameState.monster.name}</h3>
                                        <div class="bg-black/50 rounded-lg p-3 inline-block w-full max-w-xs">
                                            <div class="flex items-center justify-center gap-2 mb-2">
                                                <span>‚ù§Ô∏è</span>
                                                <span class="font-bold text-lg md:text-xl">${gameState.monster.hp}/${gameState.monster.maxHp}</span>
                                            </div>
                                            <div class="w-full bg-black/50 rounded-full h-4 overflow-hidden">
                                                <div 
                                                    class="bg-gradient-to-r from-red-600 to-pink-500 h-full transition-all duration-300"
                                                    style="width: ${(gameState.monster.hp / gameState.monster.maxHp) * 100}%"
                                                ></div>
                                            </div>
                                        </div>
                                        
                                        <div class="mt-4 text-yellow-300 text-sm animate-pulse">
                                            üëÜ CLICK ƒê·ªÇ T·∫§N C√îNG! üëÜ
                                        </div>
                                    </div>
                                    
                                    <div class="absolute inset-0 bg-gradient-to-r from-red-500/20 to-orange-500/20 blur-xl opacity-50 pointer-events-none"></div>
                                </div>

                                <!-- VS -->
                                <div class="text-center">
                                    <span class="text-3xl md:text-4xl font-bold bg-gradient-to-r from-yellow-400 to-red-500 bg-clip-text text-transparent">
                                        ‚ö° VS ‚ö°
                                    </span>
                                </div>

                                <!-- Player -->
                                <div class="bg-blue-900/30 rounded-xl p-4 border-2 border-blue-500/50">
                                    <div class="text-center">
                                        <div class="text-5xl md:text-6xl mb-2">üõ°Ô∏è</div>
                                        <h3 class="font-bold text-lg md:text-xl text-blue-300">${gameState.player.name}</h3>
                                        <div class="mt-2">
                                            <div class="flex items-center justify-center gap-2 mb-1">
                                                <span>‚ù§Ô∏è</span>
                                                <span class="font-bold">${gameState.player.hp}/${stats.totalHp}</span>
                                            </div>
                                            <div class="w-full bg-black/50 rounded-full h-3 overflow-hidden">
                                                <div 
                                                    class="bg-gradient-to-r from-green-600 to-emerald-500 h-full transition-all duration-300"
                                                    style="width: ${(gameState.player.hp / stats.totalHp) * 100}%"
                                                ></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Stats Info -->
                                <div class="bg-black/30 rounded-lg p-3 text-center text-sm">
                                    <div class="flex justify-around flex-wrap gap-2">
                                        <span>‚öîÔ∏è ATK: <strong class="text-orange-400">${stats.totalAtk}</strong></span>
                                        <span>üõ°Ô∏è DEF: <strong class="text-blue-400">${stats.totalDef}</strong></span>
                                        <span>‚ö° CRIT: <strong class="text-yellow-400">${stats.totalCrit}%</strong></span>
                                    </div>
                                </div>
                            </div>
                        `}
                    </div>

                    <!-- Battle Log & Equipment -->
                    <div class="space-y-4 md:space-y-6">
                        <!-- Battle Log -->
                        <div class="bg-black/50 rounded-2xl p-4 md:p-6 border-2 border-purple-500/30">
                            <h3 class="text-lg md:text-xl font-bold mb-4 flex items-center gap-2">
                                <span>‚ú®</span>
                                Nh·∫≠t K√Ω Chi·∫øn ƒê·∫•u
                            </h3>
                            <div class="space-y-2 max-h-48 md:max-h-64 overflow-y-auto">
                                ${gameState.battleLog.length === 0 ? 
                                    '<p class="text-purple-300 text-center py-4">Ch∆∞a c√≥ tr·∫≠n chi·∫øn n√†o...</p>' :
                                    gameState.battleLog.map(log => `
                                        <div class="p-2 rounded-lg text-sm ${
                                            log.type === 'success' ? 'bg-green-900/30 text-green-300' :
                                            log.type === 'error' ? 'bg-red-900/30 text-red-300' :
                                            'bg-blue-900/30 text-blue-300'
                                        }">
                                            ${log.message}
                                        </div>
                                    `).join('')
                                }
                            </div>
                        </div>

                        <!-- Equipment -->
                        <div class="bg-gradient-to-br from-purple-900/50 to-pink-900/50 rounded-2xl p-4 md:p-6 border-2 border-purple-500/30">
                            <h3 class="text-lg md:text-xl font-bold mb-4 flex items-center gap-2">
                                <span>üëë</span>
                                Trang B·ªã Hi·ªán T·∫°i
                            </h3>
                            <div class="space-y-3">
                                <div class="bg-black/30 p-3 rounded-lg">
                                    <div class="flex items-center justify-between text-sm md:text-base">
                                        <span class="text-purple-300">‚öîÔ∏è V≈© Kh√≠:</span>
                                        <span class="font-bold">${gameState.player.weapon ? `${gameState.player.weapon.icon} ${gameState.player.weapon.name}` : 'Ch∆∞a c√≥'}</span>
                                    </div>
                                </div>
                                <div class="bg-black/30 p-3 rounded-lg">
                                    <div class="flex items-center justify-between text-sm md:text-base">
                                        <span class="text-purple-300">üõ°Ô∏è Gi√°p:</span>
                                        <span class="font-bold">${gameState.player.armor ? `${gameState.player.armor.icon} ${gameState.player.armor.name}` : 'Ch∆∞a c√≥'}</span>
                                    </div>
                                </div>
                                <div class="bg-black/30 p-3 rounded-lg">
                                    <div class="flex items-center justify-between text-sm md:text-base">
                                        <span class="text-purple-300">üêæ Pet:</span>
                                        <span class="font-bold">${gameState.player.pet ? `${gameState.player.pet.icon} ${gameState.player.pet.name}` : 'Ch∆∞a c√≥'}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderUpgradeView() {
            const upgradeItems = [
                { 
                    stat: 'atk', 
                    label: 'S·ª©c M·∫°nh', 
                    icon: '‚öîÔ∏è', 
                    current: gameState.player.atk, 
                    bonus: '+5 ATK', 
                    color: 'from-orange-500 to-red-600', 
                    cost: 100 + gameState.player.atk * 50 
                },
                { 
                    stat: 'hp', 
                    label: 'M√°u', 
                    icon: '‚ù§Ô∏è', 
                    current: gameState.player.maxHp, 
                    bonus: '+20 HP', 
                    color: 'from-red-500 to-pink-600', 
                    cost: 150 + gameState.player.maxHp * 2 
                },
                { 
                    stat: 'crit', 
                    label: 'Ch√≠ M·∫°ng', 
                    icon: '‚ö°', 
                    current: gameState.player.crit, 
                    bonus: '+2% CRIT', 
                    color: 'from-yellow-500 to-orange-600', 
                    cost: 200 + gameState.player.crit * 100 
                }
            ];

            return `
                <div class="max-w-4xl mx-auto">
                    <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center bg-gradient-to-r from-yellow-400 to-pink-500 bg-clip-text text-transparent">
                        ‚¨ÜÔ∏è N√ÇNG C·∫§P NH√ÇN V·∫¨T
                    </h2>
                    <div class="grid md:grid-cols-3 gap-4">
                        ${upgradeItems.map(item => `
                            <div class="bg-gradient-to-br from-purple-900/50 to-blue-900/50 rounded-2xl p-4 md:p-6 border-2 border-purple-500/30">
                                <div class="text-center mb-4">
                                    <div class="text-4xl md:text-5xl mb-2">${item.icon}</div>
                                    <h3 class="font-bold text-lg md:text-xl">${item.label}</h3>
                                    <p class="text-purple-300 text-sm mt-1">Hi·ªán t·∫°i: ${item.current}</p>
                                </div>
                                <button
                                    onclick="upgradeStats('${item.stat}'); render();"
                                    class="w-full py-3 bg-gradient-to-r ${item.color} hover:scale-105 rounded-xl font-bold shadow-lg transform transition-all"
                                >
                                    ${item.bonus}
                                    <div class="text-sm mt-1">üí∞ ${item.cost.toLocaleString()}ƒë</div>
                                </button>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div class="mt-6 bg-yellow-900/30 border-2 border-yellow-500/50 rounded-xl p-4">
                        <p class="text-center text-yellow-300 text-sm">
                            üí° <strong>M·∫πo:</strong> Gi√° n√¢ng c·∫•p tƒÉng d·∫ßn theo stats hi·ªán t·∫°i c·ªßa b·∫°n!
                        </p>
                    </div>
                </div>
            `;
        }

        function renderShopView() {
            return `
                <div class="space-y-6 md:space-y-8">
                    <!-- Weapon Shop -->
                    <div>
                        <h2 class="text-2xl md:text-3xl font-bold mb-4 text-center bg-gradient-to-r from-yellow-400 to-orange-500 bg-clip-text text-transparent">
                            ‚öîÔ∏è SHOP V≈® KH√ç
                        </h2>
                        <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-3 md:gap-4">
                            ${weaponShop.map(weapon => `
                                <div class="bg-gradient-to-br from-orange-900/50 to-red-900/50 rounded-xl p-3 md:p-4 border-2 border-orange-500/30 hover:border-orange-400 transition-all hover:scale-105">
                                    <div class="text-center">
                                        <div class="text-3xl md:text-4xl mb-2">${weapon.icon}</div>
                                        <h3 class="font-bold text-sm md:text-base">${weapon.name}</h3>
                                        <p class="text-orange-300 text-xs md:text-sm">+${weapon.atk} ATK</p>
                                        <button
                                            onclick="buyItem(${JSON.stringify(weapon).replace(/"/g, '&quot;')}, 'weapon'); render();"
                                            ${gameState.player.weapon?.name === weapon.name ? 'disabled' : ''}
                                            class="mt-3 w-full py-2 rounded-lg font-bold text-xs md:text-sm ${
                                                gameState.player.weapon?.name === weapon.name
                                                    ? 'bg-gray-600 cursor-not-allowed'
                                                    : 'bg-gradient-to-r from-yellow-500 to-orange-600 hover:from-yellow-600 hover:to-orange-700'
                                            }"
                                        >
                                            ${gameState.player.weapon?.name === weapon.name ? '‚úì ƒêang d√πng' : `üí∞ ${weapon.price}ƒë`}
                                        </button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- Armor Shop -->
                    <div>
                        <h2 class="text-2xl md:text-3xl font-bold mb-4 text-center bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent">
                            üõ°Ô∏è SHOP GI√ÅP
                        </h2>
                        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3 md:gap-4">
                            ${armorShop.map(armor => `
                                <div class="bg-gradient-to-br from-blue-900/50 to-purple-900/50 rounded-xl p-3 md:p-4 border-2 border-blue-500/30 hover:border-blue-400 transition-all hover:scale-105">
                                    <div class="text-center">
                                        <div class="text-3xl md:text-4xl mb-2">${armor.icon}</div>
                                        <h3 class="font-bold text-sm">${armor.name}</h3>
                                        <p class="text-blue-300 text-xs">+${armor.def} DEF</p>
                                        <p class="text-red-300 text-xs">+${armor.hp} HP</p>
                                        <button
                                            onclick="buyItem(${JSON.stringify(armor).replace(/"/g, '&quot;')}, 'armor'); render();"
                                            ${gameState.player.armor?.name === armor.name ? 'disabled' : ''}
                                            class="mt-3 w-full py-2 rounded-lg font-bold text-xs md:text-sm ${
                                                gameState.player.armor?.name === armor.name
                                                    ? 'bg-gray-600 cursor-not-allowed'
                                                    : 'bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700'
                                            }"
                                        >
                                            ${gameState.player.armor?.name === armor.name ? '‚úì ƒêang d√πng' : `üí∞ ${armor.price}ƒë`}
                                        </button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>

                    <!-- Pet Shop -->
                    <div>
                        <h2 class="text-2xl md:text-3xl font-bold mb-4 text-center bg-gradient-to-r from-green-400 to-emerald-500 bg-clip-text text-transparent">
                            üêæ SHOP PET
                        </h2>
                        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3 md:gap-4">
                            ${petShop.map(pet => `
                                <div class="bg-gradient-to-br from-green-900/50 to-emerald-900/50 rounded-xl p-3 md:p-4 border-2 border-green-500/30 hover:border-green-400 transition-all hover:scale-105">
                                    <div class="text-center">
                                        <div class="text-3xl md:text-4xl mb-2">${pet.icon}</div>
                                        <h3 class="font-bold text-sm">${pet.name}</h3>
                                        <p class="text-green-300 text-xs">+${pet.atkBonus}% ATK</p>
                                        <button
                                            onclick="buyItem(${JSON.stringify(pet).replace(/"/g, '&quot;')}, 'pet'); render();"
                                            ${gameState.player.pet?.name === pet.name ? 'disabled' : ''}
                                            class="mt-3 w-full py-2 rounded-lg font-bold text-xs md:text-sm ${
                                                gameState.player.pet?.name === pet.name
                                                    ? 'bg-gray-600 cursor-not-allowed'
                                                    : 'bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700'
                                            }"
                                        >
                                            ${gameState.player.pet?.name === pet.name ? '‚úì ƒêang d√πng' : `üí∞ ${pet.price}ƒë`}
                                        </button>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        function renderBossView() {
            return `
                <div class="max-w-4xl mx-auto">
                    <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center bg-gradient-to-r from-red-400 to-orange-500 bg-clip-text text-transparent">
                        üëë BOSS T·ª∞ CH·ªåN
                    </h2>
                    <div class="grid md:grid-cols-2 gap-4 md:gap-6">
                        <!-- Daily Boss -->
                        <div class="bg-gradient-to-br from-red-900/50 to-orange-900/50 rounded-2xl p-4 md:p-6 border-2 border-red-500/30">
                            <div class="text-center mb-4">
                                <div class="text-5xl md:text-6xl mb-2">üî•</div>
                                <h3 class="text-xl md:text-2xl font-bold text-red-300">BOSS NG√ÄY</h3>
                                <p class="text-sm text-orange-300 mt-2">Ph·∫ßn th∆∞·ªüng x5 V√†ng!</p>
                            </div>
                            <div class="bg-black/30 rounded-lg p-3 mb-4">
                                <p class="text-center">L∆∞·ª£t c√≤n l·∫°i: <span class="font-bold text-yellow-400">${gameState.player.dailyBosses}/2</span></p>
                                <p class="text-xs text-purple-300 text-center mt-1">Reset m·ªói 24 gi·ªù</p>
                            </div>
                            <button
                                onclick="startBattle('daily'); render();"
                                ${gameState.player.dailyBosses <= 0 ? 'disabled' : ''}
                                class="w-full py-4 rounded-xl font-bold text-lg shadow-lg transform transition-all ${
                                    gameState.player.dailyBosses > 0
                                        ? 'bg-gradient-to-r from-red-500 to-orange-600 hover:from-red-600 hover:to-orange-700 hover:scale-105'
                                        : 'bg-gray-600 cursor-not-allowed opacity-50'
                                }"
                            >
                                ${gameState.player.dailyBosses > 0 ? '‚öîÔ∏è TH√ÅCH ƒê·∫§U' : '‚ùå H·∫øt l∆∞·ª£t'}
                            </button>
                        </div>

                        <!-- Weekly Boss -->
                        <div class="bg-gradient-to-br from-purple-900/50 to-pink-900/50 rounded-2xl p-4 md:p-6 border-2 border-purple-500/30">
                            <div class="text-center mb-4">
                                <div class="text-5xl md:text-6xl mb-2">‚ö°</div>
                                <h3 class="text-xl md:text-2xl font-bold text-purple-300">BOSS TU·∫¶N</h3>
                                <p class="text-sm text-pink-300 mt-2">Ph·∫ßn th∆∞·ªüng x10 V√†ng!</p>
                            </div>
                            <div class="bg-black/30 rounded-lg p-3 mb-4">
                                <p class="text-center">L∆∞·ª£t c√≤n l·∫°i: <span class="font-bold text-yellow-400">${gameState.player.weeklyBosses}/3</span></p>
                                <p class="text-xs text-purple-300 text-center mt-1">Reset m·ªói 7 ng√†y</p>
                            </div>
                            <button
                                onclick="startBattle('weekly'); render();"
                                ${gameState.player.weeklyBosses <= 0 ? 'disabled' : ''}
                                class="w-full py-4 rounded-xl font-bold text-lg shadow-lg transform transition-all ${
                                    gameState.player.weeklyBosses > 0
                                        ? 'bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 hover:scale-105'
                                        : 'bg-gray-600 cursor-not-allowed opacity-50'
                                }"
                            >
                                ${gameState.player.weeklyBosses > 0 ? '‚öîÔ∏è TH√ÅCH ƒê·∫§U' : '‚ùå H·∫øt l∆∞·ª£t'}
                            </button>
                        </div>
                    </div>

                    <div class="mt-6 bg-blue-900/30 border-2 border-blue-500/50 rounded-xl p-4">
                        <h3 class="font-bold text-center mb-2">üìù L∆∞u √Ω:</h3>
                        <ul class="text-sm text-blue-200 space-y-1">
                            <li>‚Ä¢ Boss ng√†y/tu·∫ßn m·∫°nh h∆°n r·∫•t nhi·ªÅu so v·ªõi qu√°i th∆∞·ªùng</li>
                            <li>‚Ä¢ ƒê·∫£m b·∫£o trang b·ªã ƒë·ªß m·∫°nh tr∆∞·ªõc khi th√°ch ƒë·∫•u</li>
                            <li>‚Ä¢ Ph·∫ßn th∆∞·ªüng cao h∆°n nhi·ªÅu l·∫ßn so v·ªõi qu√°i th∆∞·ªùng</li>
                        </ul>
                    </div>
                </div>
            `;
        }

        function renderAdsView() {
            const adReward = calculateAdReward();
            
            return `
                <div class="max-w-4xl mx-auto">
                    <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center bg-gradient-to-r from-green-400 to-blue-500 bg-clip-text text-transparent">
                        üì∫ XEM QU·∫¢NG C√ÅO NH·∫¨N TH∆Ø·ªûNG
                    </h2>
                    
                    <div class="bg-yellow-900/30 border-2 border-yellow-500/50 rounded-xl p-4 mb-6">
                        <p class="text-center text-yellow-300 text-sm md:text-base">
                            ‚ö†Ô∏è <strong>DEMO MODE:</strong> T√≠ch h·ª£p Adsterra.com c·∫ßn backend server th·∫≠t
                        </p>
                        <p class="text-center text-yellow-200 text-xs mt-2">
                            S·ªë QC ƒë√£ xem: ${gameState.adsWatched}
                        </p>
                    </div>

                    <div class="space-y-4">
                        <!-- Stat Boosts -->
                        <div class="bg-gradient-to-br from-purple-900/50 to-blue-900/50 rounded-xl p-4 md:p-6 border-2 border-purple-500/30">
                            <h3 class="text-lg md:text-xl font-bold mb-4">‚ö° BUFF STATS (10 ph√∫t)</h3>
                            <div class="grid md:grid-cols-3 gap-3 md:gap-4">
                                ${[
                                    { type: 'hp', label: '+100 HP', icon: '‚ù§Ô∏è', color: 'from-red-500 to-pink-600' },
                                    { type: 'atk', label: '+75 ATK', icon: '‚öîÔ∏è', color: 'from-orange-500 to-red-600' },
                                    { type: 'def', label: '+10 DEF', icon: 'üõ°Ô∏è', color: 'from-blue-500 to-purple-600' }
                                ].map(boost => {
                                    const isActive = gameState.adBoosts[boost.type].active && Date.now() < gameState.adBoosts[boost.type].endTime;
                                    const timeLeft = isActive ? Math.ceil((gameState.adBoosts[boost.type].endTime - Date.now()) / 1000 / 60) : 0;
                                    
                                    return `
                                        <button
                                            onclick="watchAd('${boost.type}');"
                                            ${isActive ? 'disabled' : ''}
                                            class="py-4 rounded-xl font-bold bg-gradient-to-r ${boost.color} hover:scale-105 transform transition-all ${
                                                isActive ? 'opacity-50 cursor-not-allowed' : ''
                                            }"
                                        >
                                            <div class="text-2xl mb-1">${boost.icon}</div>
                                            <div>${boost.label}</div>
                                            ${isActive ? `<div class="text-xs mt-1">‚è≥ C√≤n ${timeLeft} ph√∫t</div>` : '<div class="text-xs mt-1">üì∫ Xem QC</div>'}
                                        </button>
                                    `;
                                }).join('')}
                            </div>
                        </div>

                        <!-- Coin Rewards -->
                        <div class="bg-gradient-to-br from-yellow-900/50 to-orange-900/50 rounded-xl p-4 md:p-6 border-2 border-yellow-500/30">
                            <h3 class="text-lg md:text-xl font-bold mb-4">üí∞ NH·∫¨N V√ÄNG</h3>
                            <div class="grid md:grid-cols-2 gap-3 md:gap-4">
                                <button
                                    onclick="watchAd('coin1');"
                                    class="py-4 rounded-xl font-bold bg-gradient-to-r from-yellow-500 to-orange-600 hover:scale-105 transform transition-all"
                                >
                                    <div class="text-2xl mb-1">üí∞</div>
                                    <div>+~${adReward}ƒë</div>
                                    <div class="text-xs mt-1">(1 QC - Ng·∫´u nhi√™n)</div>
                                </button>
                                <button
                                    onclick="watchAd('coin2');"
                                    class="py-4 rounded-xl font-bold bg-gradient-to-r from-yellow-500 to-orange-600 hover:scale-105 transform transition-all"
                                >
                                    <div class="text-2xl mb-1">üíé</div>
                                    <div>+~${adReward * 2}ƒë</div>
                                    <div class="text-xs mt-1">(2 QC - Ng·∫´u nhi√™n)</div>
                                </button>
                            </div>
                            <p class="text-xs text-yellow-200 text-center mt-3">
                                üí° S·ªë coin nh·∫≠n ph·ª• thu·ªôc v√†o ·∫£i hi·ªán t·∫°i v√† may m·∫Øn!
                            </p>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderMarketView() {
            return `
                <div class="max-w-4xl mx-auto">
                    <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center bg-gradient-to-r from-purple-400 to-pink-500 bg-clip-text text-transparent">
                        üè™ CH·ª¢ TRADE C·ª¶A MEMBER
                    </h2>
                    
                    <div class="bg-yellow-900/30 border-2 border-yellow-500/50 rounded-xl p-4 mb-6">
                        <p class="text-center text-yellow-300 text-sm md:text-base">
                            ‚ö†Ô∏è <strong>DEMO MODE:</strong> Ch·ª£ multiplayer th·∫≠t c·∫ßn backend server + database
                        </p>
                    </div>

                    <div class="grid md:grid-cols-2 gap-4 md:gap-6">
                        <!-- Market Listings -->
                        <div class="bg-gradient-to-br from-purple-900/50 to-blue-900/50 rounded-xl p-4 md:p-6 border-2 border-purple-500/30">
                            <h3 class="text-lg md:text-xl font-bold mb-4">üì¶ H√†ng ƒêang B√°n</h3>
                            <div class="space-y-2">
                                ${gameState.marketListings.length === 0 ? 
                                    '<p class="text-center text-purple-300 py-8">Ch∆∞a c√≥ h√†ng n√†o tr√™n ch·ª£</p>' :
                                    gameState.marketListings.map((item, i) => `
                                        <div class="bg-black/30 p-3 rounded-lg hover:bg-black/50 transition-all">
                                            <div class="flex justify-between items-center">
                                                <div>
                                                    <div class="font-bold">${item.name}</div>
                                                    <div class="text-xs text-purple-300">Ng∆∞·ªùi b√°n: ${item.seller}</div>
                                                </div>
                                                <button 
                                                    onclick="alert('Demo: C·∫ßn backend ƒë·ªÉ mua h√†ng')"
                                                    class="px-3 py-1 bg-green-600 hover:bg-green-700 rounded-lg text-sm"
                                                >
                                                    üí∞ ${item.price}ƒë
                                                </button>
                                            </div>
                                        </div>
                                    `).join('')
                                }
                            </div>
                            
                            <button 
                                onclick="alert('Demo: C·∫ßn backend ƒë·ªÉ ƒëƒÉng b√°n ƒë·ªì')"
                                class="w-full mt-4 py-3 bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 rounded-xl font-bold"
                            >
                                ‚ûï ƒêƒÉng B√°n ƒê·ªì
                            </button>
                        </div>

                        <!-- Trade -->
                        <div class="bg-gradient-to-br from-pink-900/50 to-purple-900/50 rounded-xl p-4 md:p-6 border-2 border-pink-500/30">
                            <h3 class="text-lg md:text-xl font-bold mb-4">ü§ù Trade Tr·ª±c Ti·∫øp</h3>
                            <div class="space-y-4">
                                <input
                                    type="text"
                                    id="tradeTargetInput"
                                    placeholder="Nh·∫≠p t√™n ng∆∞·ªùi ch∆°i..."
                                    class="w-full px-4 py-3 bg-black/30 border-2 border-pink-500/50 rounded-xl focus:border-pink-400 focus:outline-none text-white"
                                />
                                <button 
                                    onclick="alert('Demo: C·∫ßn backend ƒë·ªÉ t√¨m ng∆∞·ªùi ch∆°i')"
                                    class="w-full py-3 bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 rounded-xl font-bold"
                                >
                                    üîç T√¨m Ng∆∞·ªùi Ch∆°i
                                </button>
                                <div class="bg-black/30 rounded-lg p-4 text-center text-sm text-purple-300">
                                    <p class="mb-2">üí° <strong>H∆∞·ªõng d·∫´n Trade:</strong></p>
                                    <ol class="text-left space-y-1 text-xs">
                                        <li>1. T√¨m t√™n ng∆∞·ªùi ch∆°i mu·ªën trade</li>
                                        <li>2. Ch·ªçn ƒë·ªì mu·ªën trao ƒë·ªïi</li>
                                        <li>3. Ch·ªù ƒë·ªëi ph∆∞∆°ng ch·∫•p nh·∫≠n</li>
                                        <li>4. Ho√†n t·∫•t giao d·ªãch</li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderWithdrawView() {
            return `
                <div class="max-w-4xl mx-auto">
                    <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center bg-gradient-to-r from-green-400 to-emerald-500 bg-clip-text text-transparent">
                        üíµ R√öT TI·ªÄN
                    </h2>
                    
                    <div class="bg-red-900/30 border-2 border-red-500/50 rounded-xl p-4 mb-6">
                        <p class="text-center text-red-300 font-bold text-sm md:text-base">
                            ‚ö†Ô∏è C·∫¢NH B√ÅO: T√≠nh nƒÉng n√†y CH·ªà L√Ä GIAO DI·ªÜN DEMO
                        </p>
                        <p class="text-center text-red-200 text-xs mt-2">
                            R√∫t ti·ªÅn th·∫≠t c·∫ßn: Gi·∫•y ph√©p kinh doanh, Backend server b·∫£o m·∫≠t, T√≠ch h·ª£p Payment Gateway h·ª£p ph√°p
                        </p>
                    </div>

                    <div class="grid md:grid-cols-3 gap-3 md:gap-4 mb-6">
                        ${[
                            { method: 'bank', label: 'Ng√¢n H√†ng', icon: 'üè¶', min: '20K' },
                            { method: 'momo', label: 'MoMo', icon: 'üì±', min: '20K' },
                            { method: 'card', label: 'Th·∫ª C√†o', icon: 'üé´', min: '10K' }
                        ].map(item => `
                            <button
                                onclick="showWithdrawForm('${item.method}')"
                                class="bg-gradient-to-br from-green-900/50 to-emerald-900/50 rounded-xl p-4 md:p-6 border-2 border-green-500/30 hover:border-green-400 hover:scale-105 transition-all"
                            >
                                <div class="text-4xl md:text-5xl mb-2">${item.icon}</div>
                                <h3 class="font-bold">${item.label}</h3>
                                <p class="text-sm text-green-300">Min: ${item.min}</p>
                            </button>
                        `).join('')}
                    </div>

                    <!-- Withdraw Form -->
                    <div id="withdrawForm" class="hidden"></div>
                </div>
            `;
        }

        function showWithdrawForm(method) {
            const formContainer = document.getElementById('withdrawForm');
            formContainer.className = 'bg-gradient-to-br from-purple-900/50 to-blue-900/50 rounded-xl p-4 md:p-6 border-2 border-purple-500/30 slide-in';
            
            let formHTML = '';
            
            if (method === 'bank') {
                formHTML = `
                    <h3 class="text-xl font-bold mb-4 text-center">üè¶ R√öT QUA NG√ÇN H√ÄNG</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-bold mb-2">T√™n Ng√¢n H√†ng</label>
                            <select id="bankName" class="w-full px-4 py-3 bg-black/30 border-2 border-purple-500/50 rounded-xl focus:border-pink-500 focus:outline-none text-white">
                                <option>Vietcombank</option>
                                <option>VietinBank</option>
                                <option>BIDV</option>
                                <option>Techcombank</option>
                                <option>MB Bank</option>
                                <option>ACB</option>
                                <option>TPBank</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-bold mb-2">S·ªë T√†i Kho·∫£n</label>
                            <input type="text" id="bankAccount" placeholder="Nh·∫≠p s·ªë t√†i kho·∫£n" class="w-full px-4 py-3 bg-black/30 border-2 border-purple-500/50 rounded-xl focus:border-pink-500 focus:outline-none text-white">
                        </div>
                        <div>
                            <label class="block text-sm font-bold mb-2">T√™n Ng∆∞·ªùi Th·ª• H∆∞·ªüng</label>
                            <input type="text" id="bankOwner" placeholder="VD: NGUYEN VAN A" class="w-full px-4 py-3 bg-black/30 border-2 border-purple-500/50 rounded-xl focus:border-pink-500 focus:outline-none text-white">
                        </div>
                        <div>
                            <label class="block text-sm font-bold mb-2">S·ªë Ti·ªÅn (Min: 20,000ƒë)</label>
                            <input type="number" id="bankAmount" placeholder="20000" min="20000" class="w-full px-4 py-3 bg-black/30 border-2 border-purple-500/50 rounded-xl focus:border-pink-500 focus:outline-none text-white">
                        </div>
                        <button onclick="submitWithdraw('bank')" class="w-full py-4 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 rounded-xl font-bold text-lg">
                            ‚úÖ X√ÅC NH·∫¨N R√öT TI·ªÄN
                        </button>
                    </div>
                `;
            } else if (method === 'momo') {
                formHTML = `
                    <h3 class="text-xl font-bold mb-4 text-center">üì± R√öT QUA MOMO</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-bold mb-2">S·ªë ƒêi·ªán Tho·∫°i</label>
                            <input type="tel" id="momoPhone" placeholder="0123456789" class="w-full px-4 py-3 bg-black/30 border-2 border-purple-500/50 rounded-xl focus:border-pink-500 focus:outline-none text-white">
                        </div>
                        <div>
                            <label class="block text-sm font-bold mb-2">T√™n Ng∆∞·ªùi Th·ª• H∆∞·ªüng</label>
                            <input type="text" id="momoOwner" placeholder="NGUYEN VAN A" class="w-full px-4 py-3 bg-black/30 border-2 border-purple-500/50 rounded-xl focus:border-pink-500 focus:outline-none text-white">
                        </div>
                        <div>
                            <label class="block text-sm font-bold mb-2">S·ªë Ti·ªÅn (Min: 20,000ƒë)</label>
                            <input type="number" id="momoAmount" placeholder="20000" min="20000" class="w-full px-4 py-3 bg-black/30 border-2 border-purple-500/50 rounded-xl focus:border-pink-500 focus:outline-none text-white">
                        </div>
                        <button onclick="submitWithdraw('momo')" class="w-full py-4 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 rounded-xl font-bold text-lg">
                            ‚úÖ X√ÅC NH·∫¨N R√öT TI·ªÄN
                        </button>
                    </div>
                `;
            } else if (method === 'card') {
                formHTML = `
                    <h3 class="text-xl font-bold mb-4 text-center">üé´ R√öT TH·∫∫ C√ÄO VIETTEL</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-bold mb-2">M·ªánh Gi√°</label>
                            <select id="cardAmount" class="w-full px-4 py-3 bg-black/30 border-2 border-purple-500/50 rounded-xl focus:border-pink-500 focus:outline-none text-white">
                                <option value="10000">10,000ƒë</option>
                                <option value="20000">20,000ƒë</option>
                                <option value="50000">50,000ƒë</option>
                                <option value="100000">100,000ƒë</option>
                            </select>
                        </div>
                        <div class="bg-yellow-900/30 rounded-lg p-3 text-sm text-yellow-200">
                            <p>üìù <strong>L∆∞u √Ω:</strong></p>
                            <ul class="mt-2 space-y-1 text-xs">
                                <li>‚Ä¢ M√£ th·∫ª s·∫Ω ƒë∆∞·ª£c g·ª≠i v√†o L·ªãch S·ª≠ R√∫t Ti·ªÅn</li>
                                <li>‚Ä¢ Th·ªùi gian x·ª≠ l√Ω: 1-24 gi·ªù</li>
                                <li>‚Ä¢ Ki·ªÉm tra k·ªπ tr∆∞·ªõc khi n·∫°p</li>
                            </ul>
                        </div>
                        <button onclick="submitWithdraw('card')" class="w-full py-4 bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 rounded-xl font-bold text-lg">
                            ‚úÖ X√ÅC NH·∫¨N R√öT TH·∫∫
                        </button>
                    </div>
                `;
            }
            
            formHTML += `
                <button onclick="document.getElementById('withdrawForm').classList.add('hidden')" class="w-full mt-4 py-3 bg-gray-600 hover:bg-gray-700 rounded-xl font-bold">
                    ‚ùå H·ª¶Y
                </button>
            `;
            
            formContainer.innerHTML = formHTML;
        }

        function submitWithdraw(method) {
            let formData = {};
            
            if (method === 'bank') {
                formData = {
                    bankName: document.getElementById('bankName').value,
                    account: document.getElementById('bankAccount').value,
                    owner: document.getElementById('bankOwner').value,
                    amount: document.getElementById('bankAmount').value
                };
                
                if (!formData.account || !formData.owner || !formData.amount) {
                    alert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin!');
                    return;
                }
            } else if (method === 'momo') {
                formData = {
                    phone: document.getElementById('momoPhone').value,
                    owner: document.getElementById('momoOwner').value,
                    amount: document.getElementById('momoAmount').value
                };
                
                if (!formData.phone || !formData.owner || !formData.amount) {
                    alert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin!');
                    return;
                }
            } else if (method === 'card') {
                formData = {
                    amount: document.getElementById('cardAmount').value
                };
            }
            
            withdrawMoney(method, formData);
        }

        function renderWithdrawHistoryView() {
            return `
                <div class="max-w-4xl mx-auto">
                    <h2 class="text-2xl md:text-3xl font-bold mb-6 text-center bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent">
                        üìú L·ªäCH S·ª¨ R√öT TI·ªÄN
                    </h2>
                    
                    <div class="space-y-4">
                        ${gameState.withdrawHistory.length === 0 ? `
                            <div class="bg-gradient-to-br from-purple-900/50 to-blue-900/50 rounded-xl p-8 border-2 border-purple-500/30 text-center">
                                <div class="text-6xl mb-4">üì≠</div>
                                <p class="text-purple-300">Ch∆∞a c√≥ l·ªãch s·ª≠ r√∫t ti·ªÅn</p>
                            </div>
                        ` : gameState.withdrawHistory.map(record => `
                            <div class="bg-gradient-to-br from-purple-900/50 to-blue-900/50 rounded-xl p-4 md:p-6 border-2 border-purple-500/30">
                                <div class="flex justify-between items-start mb-3">
                                    <div>
                                        <div class="font-bold text-lg">
                                            ${record.method === 'bank' ? 'üè¶ Ng√¢n H√†ng' : record.method === 'momo' ? 'üì± MoMo' : 'üé´ Th·∫ª C√†o'}
                                        </div>
                                        <div class="text-sm text-purple-300">${record.date}</div>
                                    </div>
                                    <div class="text-right">
                                        <div class="font-bold text-yellow-400 text-xl">${parseInt(record.amount).toLocaleString()}ƒë</div>
                                        <div class="text-xs px-2 py-1 rounded-full ${
                                            record.status === 'Ho√†n t·∫•t' ? 'bg-green-900/50 text-green-300' : 'bg-yellow-900/50 text-yellow-300'
                                        }">
                                            ${record.status}
                                        </div>
                                    </div>
                                </div>
                                
                                ${record.method === 'bank' ? `
                                    <div class="grid grid-cols-2 gap-2 text-sm">
                                        <div class="bg-black/30 p-2 rounded">
                                            <div class="text-purple-300">Ng√¢n h√†ng:</div>
                                            <div class="font-bold">${record.details.bankName}</div>
                                        </div>
                                        <div class="bg-black/30 p-2 rounded">
                                            <div class="text-purple-300">STK:</div>
                                            <div class="font-bold">${record.details.account}</div>
                                        </div>
                                        <div class="bg-black/30 p-2 rounded col-span-2">
                                            <div class="text-purple-300">Ch·ªß TK:</div>
                                            <div class="font-bold">${record.details.owner}</div>
                                        </div>
                                    </div>
                                ` : record.method === 'momo' ? `
                                    <div class="grid grid-cols-2 gap-2 text-sm">
                                        <div class="bg-black/30 p-2 rounded">
                                            <div class="text-purple-300">SƒêT:</div>
                                            <div class="font-bold">${record.details.phone}</div>
                                        </div>
                                        <div class="bg-black/30 p-2 rounded">
                                            <div class="text-purple-300">T√™n:</div>
                                            <div class="font-bold">${record.details.owner}</div>
                                        </div>
                                    </div>
                                ` : `
                                    <div class="bg-black/30 p-3 rounded">
                                        ${record.code ? `
                                            <div class="text-sm text-purple-300 mb-1">M√£ th·∫ª:</div>
                                            <div class="font-mono font-bold text-lg text-green-400 mb-2">${record.code}</div>
                                            <div class="text-xs text-yellow-200">
                                                ‚ö†Ô∏è Vui l√≤ng sao ch√©p m√£ v√† n·∫°p trong 30 ng√†y
                                            </div>
                                        ` : `
                                            <div class="text-yellow-300">‚è≥ ƒêang x·ª≠ l√Ω m√£ th·∫ª...</div>
                                        `}
                                    </div>
                                `}
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // ==================== MAIN RENDER ====================
        function render() {
            const root = document.getElementById('root');
            
            if (!gameState.gameStarted) {
                root.innerHTML = renderCharacterCreation();
                
                const nameInput = document.getElementById('playerNameInput');
                if (nameInput) {
                    nameInput.addEventListener('input', () => {
                        gameState.nameError = '';
                    });
                }
                return;
            }

            const stats = getTotalStats();

            root.innerHTML = `
                <div class="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 text-white">
                    <!-- Header -->
                    <div class="bg-gradient-to-r from-purple-900/80 to-blue-900/80 backdrop-blur-lg border-b-2 border-purple-500/30 shadow-xl">
                        <div class="max-w-7xl mx-auto px-3 md:px-4 py-3 md:py-4">
                            <div class="flex items-center justify-between flex-wrap gap-3 md:gap-4">
                                <div>
                                    <h1 class="text-xl md:text-2xl font-bold bg-gradient-to-r from-yellow-400 to-pink-500 bg-clip-text text-transparent">
                                        üë§ ${gameState.player.name}
                                    </h1>
                                    <p class="text-xs md:text-sm text-purple-300">Level ${gameState.player.level} ‚Ä¢ ·∫¢i ${gameState.player.currentStage}</p>
                                </div>
                                
                                <div class="flex gap-2 md:gap-4 flex-wrap">
                                    <div class="bg-black/30 px-3 md:px-4 py-2 rounded-lg border border-yellow-500/30">
                                        <div class="flex items-center gap-2">
                                            <span class="text-xl md:text-2xl">üí∞</span>
                                            <span class="font-bold text-yellow-400 text-sm md:text-base">${gameState.player.gold.toLocaleString()}ƒë</span>
                                        </div>
                                    </div>
                                    
                                    <div class="bg-black/30 px-3 md:px-4 py-2 rounded-lg border border-blue-500/30">
                                        <div class="flex items-center gap-2">
                                            <span class="text-sm md:text-base">‚≠ê</span>
                                            <span class="font-bold text-sm md:text-base">${gameState.player.exp}/${gameState.player.level * 100}</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Stats Bar -->
                            <div class="mt-3 md:mt-4 grid grid-cols-2 md:grid-cols-4 gap-2">
                                <div class="bg-red-900/30 px-2 md:px-3 py-2 rounded-lg border border-red-500/30">
                                    <div class="flex items-center justify-between text-xs md:text-sm">
                                        <span>‚ù§Ô∏è</span>
                                        <span class="font-bold">${gameState.player.hp}/${stats.totalHp}</span>
                                    </div>
                                </div>
                                <div class="bg-orange-900/30 px-2 md:px-3 py-2 rounded-lg border border-orange-500/30">
                                    <div class="flex items-center justify-between text-xs md:text-sm">
                                        <span>‚öîÔ∏è</span>
                                        <span class="font-bold">ATK: ${stats.totalAtk}</span>
                                    </div>
                                </div>
                                <div class="bg-blue-900/30 px-2 md:px-3 py-2 rounded-lg border border-blue-500/30">
                                    <div class="flex items-center justify-between text-xs md:text-sm">
                                        <span>üõ°Ô∏è</span>
                                        <span class="font-bold">DEF: ${stats.totalDef}</span>
                                    </div>
                                </div>
                                <div class="bg-yellow-900/30 px-2 md:px-3 py-2 rounded-lg border border-yellow-500/30">
                                    <div class="flex items-center justify-between text-xs md:text-sm">
                                        <span>‚ö°</span>
                                        <span class="font-bold">CRIT: ${stats.totalCrit}%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Navigation -->
                    <div class="bg-black/30 border-b border-purple-500/30 sticky top-0 z-10">
                        <div class="max-w-7xl mx-auto px-2 md:px-4">
                            <div class="flex gap-1 md:gap-2 overflow-x-auto py-2 scrollbar-hide">
                                ${[
                                    { id: 'game', label: '‚öîÔ∏è Chi·∫øn ƒê·∫•u', short: '‚öîÔ∏è' },
                                    { id: 'upgrade', label: '‚¨ÜÔ∏è N√¢ng C·∫•p', short: '‚¨ÜÔ∏è' },
                                    { id: 'shop', label: 'üõí C·ª≠a H√†ng', short: 'üõí' },
                                    { id: 'boss', label: 'üëë Boss', short: 'üëë' },
                                    { id: 'ads', label: 'üì∫ Qu·∫£ng C√°o', short: 'üì∫' },
                                    { id: 'market', label: 'üè™ Ch·ª£', short: 'üè™' },
                                    { id: 'withdraw', label: 'üíµ R√∫t Ti·ªÅn', short: 'üíµ' },
                                    { id: 'withdraw-history', label: 'üìú L·ªãch S·ª≠', short: 'üìú' },
                                ].map(nav => `
                                    <button
                                        onclick="gameState.currentView = '${nav.id}'; render();"
                                        class="px-2 md:px-4 py-2 rounded-lg font-bold whitespace-nowrap transition-all text-xs md:text-sm ${
                                            gameState.currentView === nav.id
                                                ? 'bg-gradient-to-r from-pink-500 to-purple-600 shadow-lg'
                                                : 'bg-purple-800/30 hover:bg-purple-700/50'
                                        }"
                                    >
                                        <span class="md:hidden">${nav.short}</span>
                                        <span class="hidden md:inline">${nav.label}</span>
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                    </div>

                    <!-- Main Content -->
                    <div class="max-w-7xl mx-auto px-3 md:px-4 py-4 md:py-6">
                        ${gameState.currentView === 'game' ? renderGameView() : ''}
                        ${gameState.currentView === 'upgrade' ? renderUpgradeView() : ''}
                        ${gameState.currentView === 'shop' ? renderShopView() : ''}
                        ${gameState.currentView === 'boss' ? renderBossView() : ''}
                        ${gameState.currentView === 'ads' ? renderAdsView() : ''}
                        ${gameState.currentView === 'market' ? renderMarketView() : ''}
                        ${gameState.currentView === 'withdraw' ? renderWithdrawView() : ''}
                        ${gameState.currentView === 'withdraw-history' ? renderWithdrawHistoryView() : ''}
                    </div>

                    <!-- Footer -->
                    <div class="bg-black/50 border-t border-purple-500/30 mt-8 py-4">
                        <p class="text-center text-purple-300 text-xs md:text-sm">
                            ‚öîÔ∏è GAME ONLINE ‚Ä¢ Made with ‚ù§Ô∏è ‚Ä¢ Demo Version
                        </p>
                    </div>
                </div>
            `;
        }

        // ==================== INITIALIZATION ====================
        function init() {
            const savedState = loadGameState();
            if (savedState && savedState.name) {
                gameState.player = savedState;
                gameState.gameStarted = true;
            }

            const savedHistory = localStorage.getItem('rpgWithdrawHistory');
            if (savedHistory) {
                try {
                    gameState.withdrawHistory = JSON.parse(savedHistory);
                } catch (e) {}
            }

            const savedAutoFight = localStorage.getItem('rpgAutoFight');
            if (savedAutoFight) {
                try {
                    gameState.autoFight = JSON.parse(savedAutoFight);
                } catch (e) {}
            }

            // Check daily/weekly reset
            setInterval(() => {
                const now = Date.now();
                const dayMs = 24 * 60 * 60 * 1000;
                const weekMs = 7 * dayMs;

                let updated = false;

                if (now - gameState.player.lastDailyReset > dayMs) {
                    gameState.player.dailyBosses = 2;
                    gameState.player.lastDailyReset = now;
                    updated = true;
                }

                if (now - gameState.player.lastWeeklyReset > weekMs) {
                    gameState.player.weeklyBosses = 3;
                    gameState.player.lastWeeklyReset = now;
                    updated = true;
                }

                if (updated) {
                    saveGame();
                    render();
                }
            }, 60000);

            render();
        }

        // Start game
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }
    </script>
</body>
</html>
